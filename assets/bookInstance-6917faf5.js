import{_ as M,u as R,s as T,e as z,f as G,p as b,g as C,x as V,h as K,y as Y,b as D,o as l,c as a,a as t,i as H,w as J,t as r,F as f,r as g,l as k,k as O,q as x,v as y,n as W,d as X}from"./index-fb0b7d97.js";import{_ as Z}from"./QuoteContent-d3ba4e08.js";const $={components:{QuoteContent:Z},setup(){R();const _=T(),o=z(),I=G(),e=b(null),m=b(!1),B=b(!1),i=b([]),p=b(!1),s=b({}),d=b(""),v=C(()=>e.value?I.getQuotesByBook(e.value.id):[]),E=C(()=>v.value.filter(n=>n.isFavorite)),U=C(()=>p.value?E.value:v.value),w=()=>{const n=_.params.id,c=o.getBookById(n);c?(e.value=c,e.value.additionalInfo||(e.value.additionalInfo={}),F()):console.error("Book not found:",n)},F=()=>{var c;const n=((c=e.value)==null?void 0:c.additionalInfo)||{};i.value=Object.entries(n).map(([h,u])=>({key:h,value:u})),i.value.length===0&&i.value.push({key:"",value:""})},j=()=>{m.value=!0,s.value={title:e.value.title,author:e.value.author,cover:e.value.cover||"",stars:e.value.stars},d.value=e.value.tags?e.value.tags.join(", "):"",F()},Q=()=>{m.value=!1,s.value={},d.value="",F()},A=()=>{if(!e.value)return;const n=d.value?d.value.split(",").map(u=>u.trim()).filter(u=>u):[],c={};i.value.forEach(u=>{u.key.trim()&&u.value.trim()&&(c[u.key.trim()]=u.value.trim())});const h={...e.value,title:s.value.title,author:s.value.author,cover:s.value.cover,stars:s.value.stars,tags:n,additionalInfo:c,lastModified:new Date().toISOString()};o.updateBook(e.value.id,h),e.value=h,m.value=!1},N=()=>{i.value.push({key:"",value:""})},P=n=>{i.value.splice(n,1),i.value.length===0&&i.value.push({key:"",value:""})},S=n=>{n.key==="Escape"&&m.value&&Q()},q=n=>{if(!n)return"Unknown";try{return new Date(n).toLocaleDateString()}catch{return"Invalid Date"}};V(()=>_.params.id,()=>{w()});const L=n=>{if(m.value)s.value.stars=n;else{if(!e.value)return;o.updateBook(e.value.id,{...e.value,stars:n,lastModified:new Date().toISOString()}),e.value.stars=n,e.value.lastModified=new Date().toISOString()}};return V(()=>_.params.id,()=>{w()}),K(()=>{w(),document.addEventListener("keydown",S)}),Y(()=>{document.removeEventListener("keydown",S)}),{book:e,bookQuotes:v,favoriteQuotes:E,displayedQuotes:U,isEditing:m,isEditingInfo:B,editableFields:i,showFavoritesOnly:p,editForm:s,tagsInput:d,startEditing:j,cancelEditing:Q,saveChanges:A,addField:N,removeField:P,updateStars:L,formatDate:q}}},ee={class:"container mx-auto p-4"},te={key:0,class:"text-center py-8"},oe={key:1},se={class:"flex flex-col md:flex-row items-center gap-6 mb-6"},le=["src"],ae={key:1,class:"w-64 h-64 border flex justify-center items-center rounded-lg bg-gray-50"},ne={class:"flex flex-col flex-1"},re={key:0},de={class:"flex justify-between items-start mb-4"},ie={class:"flex-1"},ue={class:"text-3xl font-bold mb-2"},ce={class:"text-lg text-gray-600 mb-4"},ve={class:"flex items-center mb-4"},me=["onClick"],be={key:0,class:"fas fa-star mr-1"},fe={key:1,class:"far fa-star mr-1"},ge={class:"ml-2 text-gray-500"},ke={class:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-4"},xe={key:0,class:"mb-4"},ye={class:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm"},_e={class:"font-medium text-gray-700"},pe={key:1,class:"flex flex-wrap gap-2"},he={key:1},we={class:"space-y-4"},Fe={class:"flex gap-2 items-end"},Ce={class:"flex-1"},Ie={class:"flex items-center"},Be=["onClick"],Ee={key:0,class:"fas fa-star mr-1"},Qe={key:1,class:"far fa-star mr-1"},Se={class:"ml-2 text-gray-500"},Ve=["onUpdate:modelValue"],De=["onUpdate:modelValue"],Oe=["onClick"],Ue={class:"mt-5 flex w-full justify-end"},je={class:"flex gap-2"},Ae={class:"bg-white rounded-lg shadow p-6"},Ne={class:"flex justify-between items-center mb-4"},Pe={class:"text-2xl font-bold"},qe={class:"flex gap-2"},Le={key:0,class:"text-gray-500 text-center py-8"},Me={key:1,class:"space-y-4"};function Re(_,o,I,e,m,B){const i=D("router-link"),p=D("QuoteContent");return l(),a("div",ee,[e.book?(l(),a("div",oe,[t("div",se,[e.book.cover?(l(),a("img",{key:0,src:e.book.cover,alt:"Book Cover",class:"w-64 h-64 object-cover rounded-lg"},null,8,le)):(l(),a("div",ae,o[11]||(o[11]=[t("span",{class:"text-gray-400"},"No Cover Available",-1)]))),t("div",ne,[e.isEditing?(l(),a("div",he,[t("div",we,[t("div",Fe,[t("div",Ce,[o[16]||(o[16]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Title",-1)),x(t("input",{"onUpdate:modelValue":o[1]||(o[1]=s=>e.editForm.title=s),class:"w-full p-3 border rounded text-lg font-semibold",placeholder:"Book Title"},null,512),[[y,e.editForm.title]])])]),t("div",null,[o[17]||(o[17]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Author",-1)),x(t("input",{"onUpdate:modelValue":o[2]||(o[2]=s=>e.editForm.author=s),class:"w-full p-3 border rounded",placeholder:"Author Name"},null,512),[[y,e.editForm.author]])]),t("div",null,[o[18]||(o[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Cover Image URL",-1)),x(t("input",{"onUpdate:modelValue":o[3]||(o[3]=s=>e.editForm.cover=s),class:"w-full p-3 border rounded",placeholder:"https://example.com/cover.jpg"},null,512),[[y,e.editForm.cover]])]),t("div",null,[o[19]||(o[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Rating",-1)),t("div",Ie,[(l(),a(f,null,g(5,s=>t("span",{key:s,onClick:d=>e.editForm.stars=s,class:"text-amber-300 cursor-pointer text-xl hover:text-amber-400"},[s<=e.editForm.stars?(l(),a("i",Ee)):(l(),a("i",Qe))],8,Be)),64)),t("span",Se,"("+r(e.editForm.stars)+"/5)",1)])]),t("div",null,[o[20]||(o[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Tags (comma-separated)",-1)),x(t("input",{"onUpdate:modelValue":o[4]||(o[4]=s=>e.tagsInput=s),class:"w-full p-3 border rounded",placeholder:"Classic, Fiction, Romance"},null,512),[[y,e.tagsInput]])]),t("div",null,[o[21]||(o[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"Additional Information",-1)),(l(!0),a(f,null,g(e.editableFields,(s,d)=>(l(),a("div",{key:d,class:"flex gap-2 items-center mb-2"},[x(t("input",{"onUpdate:modelValue":v=>s.key=v,placeholder:"Field name (e.g., Genre, Year, Publisher)",class:"flex-1 p-2 border rounded"},null,8,Ve),[[y,s.key]]),x(t("input",{"onUpdate:modelValue":v=>s.value=v,placeholder:"Value",class:"flex-1 p-2 border rounded"},null,8,De),[[y,s.value]]),t("button",{onClick:v=>e.removeField(d),class:"text-red-500 hover:text-red-700 px-2"}," ✕ ",8,Oe)]))),128)),t("button",{onClick:o[5]||(o[5]=(...s)=>e.addField&&e.addField(...s)),class:"bg-white text-blue-500 border border-blue-300 px-3 py-1 rounded hover:bg-blue-100 text-sm"}," Add Field "),t("div",Ue,[t("div",je,[t("button",{onClick:o[6]||(o[6]=(...s)=>e.saveChanges&&e.saveChanges(...s)),class:"bg-blue-200 text-blue-800 hover:bg-blue-300 px-3 py-1 rounded"}," Save "),t("button",{onClick:o[7]||(o[7]=(...s)=>e.cancelEditing&&e.cancelEditing(...s)),class:"bg-gray-200 text-gray-800 hover:bg-gray-300 px-3 py-1 rounded"}," Cancel ")])])])])])):(l(),a("div",re,[t("div",de,[t("div",ie,[t("h1",ue,r(e.book.title),1),t("p",ce,"by "+r(e.book.author),1)]),t("button",{onClick:o[0]||(o[0]=(...s)=>e.startEditing&&e.startEditing(...s)),class:"bg-customPurple-200 hover:bg-customPurple-400 text-customPurple-900 px-4 py-1 rounded"}," Edit ")]),t("div",ve,[(l(),a(f,null,g(5,s=>t("span",{key:s,onClick:d=>e.updateStars(s),class:"text-amber-300 cursor-pointer text-xl hover:text-amber-400"},[s<=e.book.stars?(l(),a("i",be)):(l(),a("i",fe))],8,me)),64)),t("span",ge,"("+r(e.book.stars)+"/5)",1)]),t("div",ke,[t("div",null,[o[12]||(o[12]=t("strong",null,"Quotes:",-1)),k(" "+r(e.bookQuotes.length),1)]),t("div",null,[o[13]||(o[13]=t("strong",null,"Favorites quotes:",-1)),k(" "+r(e.favoriteQuotes.length),1)]),t("div",null,[o[14]||(o[14]=t("strong",null,"Date Added:",-1)),k(" "+r(e.formatDate(e.book.dateAdded)),1)]),t("div",null,[o[15]||(o[15]=t("strong",null,"Last Updated:",-1)),k(" "+r(e.formatDate(e.book.lastModified)),1)])]),e.book.additionalInfo&&Object.keys(e.book.additionalInfo).length>0?(l(),a("div",xe,[t("div",ye,[(l(!0),a(f,null,g(e.book.additionalInfo,(s,d)=>(l(),a("div",{key:d,class:"flex justify-between"},[t("span",_e,[t("strong",null,r(d)+":",1),k(" "+r(s),1)])]))),128))])])):O("",!0),e.book.tags&&e.book.tags.length>0?(l(),a("div",pe,[(l(!0),a(f,null,g(e.book.tags,s=>(l(),a("span",{key:s,class:"inline-block bg-violet-100 text-violet-800 text-xs px-2 py-1 rounded-full"},r(s),1))),128))])):O("",!0)]))])]),t("div",Ae,[t("div",Ne,[t("h2",Pe,"Quotes ("+r(e.bookQuotes.length)+")",1),t("div",qe,[t("button",{onClick:o[8]||(o[8]=s=>e.showFavoritesOnly=!e.showFavoritesOnly),class:W([e.showFavoritesOnly?"bg-white text-customPurple-900 border hover:bg-customPurple-300 border-customPurple-500":"bg-white border border-yellow-400 text-yellow-600 hover:bg-yellow-100","px-3 py-1 rounded text-sm"])},r(e.showFavoritesOnly?"Show All":"Favorites Only"),3)])]),e.displayedQuotes.length===0?(l(),a("div",Le,[t("p",null,r(e.showFavoritesOnly?"No favorite quotes yet.":"No quotes available for this book."),1)])):(l(),a("div",Me,[(l(!0),a(f,null,g(e.displayedQuotes,s=>(l(),X(p,{key:s.id,quote:s},null,8,["quote"]))),128))]))])])):(l(),a("div",te,[o[10]||(o[10]=t("p",{class:"text-gray-500"},"Book not found",-1)),H(i,{to:"/books",class:"text-blue-500 hover:text-blue-700"},{default:J(()=>o[9]||(o[9]=[k("← Back to Books",-1)])),_:1,__:[9]})]))])}const Ge=M($,[["render",Re],["__scopeId","data-v-1390d72c"]]);export{Ge as default};
